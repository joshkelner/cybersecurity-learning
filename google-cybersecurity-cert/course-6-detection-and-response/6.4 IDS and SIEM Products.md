## Logs
(See earlier notes)
* **Log forwarders** - Software that collects logs from various places and forwards them to central log repo
* Log types
    * **Network**
        * Generated by firewall, router, switches, etc
    * **System**
        * Generated by OS
    * **Application**
        * Generated by software applications
    * **Security**
        * Generated by IDS or SIEM
    * **Authentication**
        * Login records
* Log details: date, time, location, action, author of action
    * Complicated to decide what info to log
    * Don't want to overlog (increases cost, load, and hurts SIEM effectiveness)
* Log retention: how long to store (various regulations)
* Log protection: vital for integrity
* Log formats
    * Some are human-readable, machine-readable, short, verbose, etc
    * **Syslog**
        * Protocol (transports and writes logs) and log format
        * Header - time, host name, application name, message id
        * Structured data - Additional info in key value pairs
        * Message
    * **JavaScript Object Notation (JSON)**
        * East to read and write
        * Key value pairs
    * **Extensible Markup Language (XML)**
        * Uses tags and keys to structure data
    * **Comma Separated Values (CSV)**
        * Uses commas to separate data
    * **Common Event Format (CEF)**
        * Has predetermined fields separated by |
        * Optional extension portion where you can add key value data
## IDS
* **Host-based (HIDS)**
    * Monitors endpoints
    * Application that just monitors device its installed on
* **Network-based (NIDS)**
    * Analyze network traffic and data
    * More like packet sniffers
* Network should have multiple IDS at different points
* **Signature analysis**
    * IDS refers to specific rules and sends alert when event matches the rules
    * Less false positives
    * Easier to evade
    * Need to update signatures for new threats
* **Anomaly analysis**
    * Identify unusual events
    * Can detect evolving threats without being programmed
    * Lots of false positives
    * If there was an attack while it was trained it won't recognize it
* Signature/rule language
    * Varies with different IDS
    * Generally three components:
    * Action
        * Alert, pass, reject based on rules
    * Header
        * Specify what network traffic is allowed or suspicious
    * Rule options
        * Customize with additional parameters
## Suricata
* Open-source signature-based 
    * Can be used as IDS, IPS, and for network security monitoring (NSM)
        * Each use is configured differently
* Comes with pre-written signatures and you can add more
* Configuration files are in suricata directory
    * Pre-written signatures are in rules folder
* Logs are in EVE JSON format
    * Alert logs
        * Output from signatures that trigger alert
    * Network telemetry logs
        * What's happening on network, not always relevant
* Suricata process rules in certain order (rule order)
    * By action then priority level
    * Pass, drop, reject, alert
* Two log outputs
    * eve.json - standard detailed info, better for parsing and SIEMS
    * fast.log - minimal information, not as useful